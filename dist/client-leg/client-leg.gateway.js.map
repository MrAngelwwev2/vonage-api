{"version":3,"sources":["../../src/client-leg/client-leg.gateway.ts"],"sourcesContent":["import { Logger } from '@nestjs/common';\nimport {\n  MessageBody,\n  OnGatewayConnection,\n  OnGatewayDisconnect,\n  OnGatewayInit,\n  SubscribeMessage,\n  WebSocketGateway,\n  WebSocketServer,\n} from '@nestjs/websockets';\n\nimport { Server } from 'socket.io';\n\n//https://medium.com/@sulthanftr/fulfilling-the-solid-principles-in-a-nest-js-api-37f0ae18dc7f\n//https://stackoverflow.com/questions/56699402/websockets-on-specific-route-in-nest-js\n@WebSocketGateway({path: '/clientLeg'})\nexport class ClientLegGateway\n  implements OnGatewayInit, OnGatewayConnection, OnGatewayDisconnect {\n  private readonly logger = new Logger(ClientLegGateway.name);\n\n  @WebSocketServer() io: Server;\n\n  afterInit() {\n    this.logger.log('Initialized');\n  }\n\n  handleConnection(client: any, ...args: any[]) {\n    const { sockets } = this.io.sockets;\n\n    this.logger.log(`Client id: ${client.id} connected`);\n    this.logger.debug(`Number of connected clients: ${sockets.size}`);\n  }\n\n  handleDisconnect(client: any) {\n    this.logger.log(`Cliend id:${client.id} disconnected`);\n  }\n\n  @SubscribeMessage('events')\n  handleEvent(@MessageBody() data: string): string {\n    return data;\n  }\n\n  @SubscribeMessage(\"message\")\n  handleMessage(client: any, data: any) {\n    this.logger.log(`Message received from client id: ${client.id}`);\n    this.logger.debug(`Payload: ${data}`);\n    return {\n      event: \"pong\",\n      data,\n    };\n  }\n}\n"],"names":["ClientLegGateway","afterInit","logger","log","handleConnection","client","args","sockets","io","id","debug","size","handleDisconnect","handleEvent","data","handleMessage","event","Logger","name","WebSocketServer","SubscribeMessage","MessageBody","WebSocketGateway","path"],"mappings":";;;;+BAgBaA;;;eAAAA;;;wBAhBU;4BAShB;0BAEgB;;;;;;;;;;;;;;;AAKhB,IAAA,AAAMA,mBAAN,MAAMA;IAMXC,YAAY;QACV,IAAI,CAACC,MAAM,CAACC,GAAG,CAAC;IAClB;IAEAC,iBAAiBC,MAAW,EAAE,GAAGC,IAAW,EAAE;QAC5C,MAAM,EAAEC,OAAO,EAAE,GAAG,IAAI,CAACC,EAAE,CAACD,OAAO;QAEnC,IAAI,CAACL,MAAM,CAACC,GAAG,CAAC,CAAC,WAAW,EAAEE,OAAOI,EAAE,CAAC,UAAU,CAAC;QACnD,IAAI,CAACP,MAAM,CAACQ,KAAK,CAAC,CAAC,6BAA6B,EAAEH,QAAQI,IAAI,CAAC,CAAC;IAClE;IAEAC,iBAAiBP,MAAW,EAAE;QAC5B,IAAI,CAACH,MAAM,CAACC,GAAG,CAAC,CAAC,UAAU,EAAEE,OAAOI,EAAE,CAAC,aAAa,CAAC;IACvD;IAGAI,YAAY,AAAeC,IAAY,EAAU;QAC/C,OAAOA;IACT;IAGAC,cAAcV,MAAW,EAAES,IAAS,EAAE;QACpC,IAAI,CAACZ,MAAM,CAACC,GAAG,CAAC,CAAC,iCAAiC,EAAEE,OAAOI,EAAE,CAAC,CAAC;QAC/D,IAAI,CAACP,MAAM,CAACQ,KAAK,CAAC,CAAC,SAAS,EAAEI,KAAK,CAAC;QACpC,OAAO;YACLE,OAAO;YACPF;QACF;IACF;;aAhCiBZ,SAAS,IAAIe,cAAM,CAACjB,iBAAiBkB,IAAI;;AAiC5D;;IA/BGC,IAAAA,2BAAe;uCAAO,gBAAM,4BAAN,gBAAM;GAJlBnB;;IAqBVoB,IAAAA,4BAAgB,EAAC;IACLC,aAAAA,IAAAA,uBAAW;;;;;;GAtBbrB;;IA0BVoB,IAAAA,4BAAgB,EAAC;;;;;;;GA1BPpB;AAAAA;IADZsB,IAAAA,4BAAgB,EAAC;QAACC,MAAM;IAAY;GACxBvB"}